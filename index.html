<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>ArcPy Scripting Techniques</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/moon.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-markdown="">
                    <script type="text/template">
                        ## ArcPy Scripting Techniques

                        ### [Shane Buscher](https://www.linkedin.com/in/shanebuscher)
                        ### [Velosys](http://www.velosys.com)
                    </script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        ## About

                        * GIS application developer
                        * HTML5, .NET, Python, SQL
                        * ArcGIS JavaScript, ArcGIS Runtime, ArcPy
                        * Diversified LOB apps
                    </script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        ## Presentation Availability

                        [Online]()

                        [PDF download]()

                        [GitHub Repository]()
                    </script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        ## Goals

                        * Address what isn't covered by samples
                        * Learn Python and ArcPy best practices
                        * Develop, debug, organize and maintain scripts
                        * Minimal Python and ArcPy experience required
                    </script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        ## The Case for ArcPy Scripting

                        * Eliminate manual and repetive GP tasks
                        * Leverage functionality not exposed by GP tools
                        * Create toolboxes for use in ArcGIS Desktop and Server
                    </script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        ## The Case for Python

                        Free | Open Source | Cross-platform

                        Widely adopted

                        Friendly to beginners and powerful for experts

                        > "It is interpreted and dynamically typed and is suited for interactive work and quick prototyping of one-off programs known as scripts while being powerful enough to write large applications in." [ESRI](http://pro.arcgis.com/en/pro-app/arcpy/get-started/what-is-arcpy-.htm)
                    </script>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Essentials

                            * At a minimum:
                                * ArcGIS Desktop or Pro --> Python and ArcPy
                                * ArcPy and Python reference documentation
                                * Text editor
                            * Recommend:
                                * Integrated Development Environment (IDE)
                                * Source control
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## ArcGIS Desktop Setup

                            * Desktop installer includes 32-bit & 64-bit Python
                                * 32-bit is installed by default
                                * [Background Geoprocessing](http://desktop.arcgis.com/en/arcmap/latest/analyze/executing-tools/64bit-background.htm) optional
                            * Python 2.7
                            * Default install: *C:\Python27*

                            Note:
                            Show Python 32 and 64 bit directories, site-packages, .pth to arcpy,
                            Show where ArcPy lib resides: C:\Program Files (x86)\ArcGIS\Desktop10.3\arcpy
                            Note ..\site-packages\DTBGGP64.pth references arcpy
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## ArcGIS Pro

                            * 64-bit | Python3.5 | [Conda](http://pro.arcgis.com/en/pro-app/arcpy/get-started/what-is-conda.htm) package manager
                            * *C:\Program Files\ArcGIS\Pro\bin\Python*
                            * [Python in ArcGIS Pro](http://pro.arcgis.com/en/pro-app/arcpy/get-started/installing-python-for-arcgis-pro.htm)
                            * [Migrating to ArcGIS Pro](http://pro.arcgis.com/en/pro-app/arcpy/get-started/python-migration-for-arcgis-pro.htm)

                            Note:
                            Show Python directory: C:\Program Files\ArcGIS\Pro\bin\Python
                            Show ArcPy lib directory: C:\Program Files\ArcGIS\Pro\Resources\ArcPy
                            Note that propy.
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Reference documentation

                            * ArcGIS Desktop
                                * [ArcGIS Desktop ArcPy Reference](http://desktop.arcgis.com/en/arcmap/10.3/analyze/arcpy/what-is-arcpy-.htm)
                                * [ArcGIS Desktop Tool Reference](http://desktop.arcgis.com/en/arcmap/10.3/main/tools/a-quick-tour-of-geoprocessing-tool-references.htm)
                                * [Python 2.7 Docs](https://docs.python.org/2/)
                            * ArcGIS Pro
                                * [ArcGIS Pro ArcPy Reference](http://pro.arcgis.com/en/pro-app/arcpy/main/arcgis-pro-arcpy-reference.htm)
                                * [ArcGIS Pro Tool Reference](http://pro.arcgis.com/en/pro-app/tool-reference/main/arcgis-pro-tool-reference.htm)
                                * [Python 3.4 Docs](https://docs.python.org/3.4/)
                            * [GeoNet](https://geonet.esri.com/community/developers/gis-developers/python/content) Python Community
                            * [PEP8](https://www.python.org/dev/peps/pep-0008/) Python style guide
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Python Code Editors

                            * Main features to look for in an IDE:
                                * Code completion
                                * Syntax and error highlighting
                                * Debugging
                            * [PyCharm Community Edition](https://www.jetbrains.com/pycharm/download/#section=windows)

                            Note:
                            IDLE comes with Desktop/Pro
                            [How to set up an IDE to use in Anaconda](https://docs.continuum.io/anaconda/ide_integration)
                            [Choosing the Right Python IDE](https://blogs.esri.com/esri/arcgis/2013/06/24/choosing-the-right-python-integrated-development-environment/)
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Source control

                            * Keep your code safe
                            * Compare (diff) your changes
                            * Restore a previous version
                            * Separate new features with branches
                            * [GitHub](http://www.github.com) | [ESRI GitHub Python Repositories](https://github.com/Esri?utf8=%E2%9C%93&q=&type=&language=python)
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            ## The Python Interactive Window
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## ArcGIS Desktop and Pro

                            ![Python window](../img/arcgis-py-window.png) <!-- .element height="75% width="75%" -->

                            Note:
                            Use TourDivide.mxd
                            Run an arcpy function in Desktop
                            Run a tool in Pro
                                count = arcpy.GetCount_management("Route")
                                Explain that you get a Result object
                                Cast to int
                            arcpy already imported
                            show code completion and note layers and mxd already referenced
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Demo: Desktop Interactive Window

                            TourDivide.mxd

                            ```
                            # Run a tool
                            result = arcpy.GetCount_management("Route")
                            result.getOutput(0)
                            count = int(result.getOutput(0))
                            ```
                            ```
                            # Run a function
                            mxd = arcpy.mapping.mapDocument("CURRENT")
                            arcpy.mapping.ExportToPDF(mxd, r"c:\Temp\TourDivide.pdf")
                            ```
                            Note:
                            arcpy already imported
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Demo: Pro Interactive Window

                            TourDivide.aprx
                            ```
                            # Create PDF the Pro way
                            from arcpy import mp
                            aprx = mp.ArcGISProject("CURRENT")
                            layout = aprx.listLayouts("Layout")[0]
                            arcpy.env.scratchFolder
                            layout.exportToPDF(arcpy.env.scratchFolder + r"TourDividePro.pdf")
                            ```
                            ```
                            # Create lines from points
                            arcpy.env.workspace = r"C:\projects\arcpy-scripting-presentation\data\Original\TourDivide.gdb"
                            arcpy.PointsToLine_management("Route", "Trail")
                            aprx.save()
                            ```
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## At The Command Prompt

                            * Desktop and Pro know python.exe location
                            * Configure python.exe to execute globally
                            * Add python.exe to your PATH environment variable
                            * Choose between 2.7 and 3.5

                            ```
                            C:\Temp> python
                            Python 2.7.8 (default, Jun 30 2014, 16:08:48) [MSC v.1500 64 bit (AMD64)] on win32
                            Type "help", "copyright", "credits" or "license" for more information.
                            >>>
                            ```
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## DEMO: Command Prompt

                            <!-- ![Python window](../img/cmd-prompt-py-win.png) -->
                            ```
                            # List feature classes
                            import arcpy
                            arcpy.env.workspace = r"C:\projects\arcpy-scripting-presentation\data\Original\TourDivide.gdb"
                            arcpy.ListFeatureClasses()
                            ```
                            ```
                            # Add feature class to MXD
                            arcpy.ListFeatureClasses()
                            from arcpy import mapping
                            mxd = mapping.MapDocument(r"C:\projects\arcpy-scripting-presentation\data\Original\Desktop\TourDivide.mxd")
                            df = arcpy.mapping.ListDataFrames(mxd)[0]
                            lyr = arcpy.mapping.Layer("Trail")
                            arcpy.mapping.AddLayer(df, lyr, "TOP")
                            mxd.save()
                            del mxd, lyr
                            ```
                            Note:
                            Don't need to open ArcGIS!
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## >>> Summary

                            * Quickly execute functions and tools
                            * Great way to experiment with syntax
                            * Not good for multiple line programs
                            * Gateway to scripting

                        </script>
                    </section>

                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Basic Scripting

                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## PyCharm IDE

                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Create a script

                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Setup

                            * Globally execute python
                            * PyCharm python.exe config
                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Running scripts

                            * From Console
                            * From PyCharm Terminal
                            * Configure PyCharm 'Run'
                        </script>
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        <script type="text/template">
                            ## Pass the Arguments

                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## GetParameters

                        </script>
                    </section>
                    <section data-markdown>
                        <script type="text/template">
                            ## GetParameters

                        </script>
                    </section>
                </section>

                <section>
                    <script src="https://gist.github.com/sbuscher/b3b90c963f5c49246dab3babb5c5b37d.js"></script>
                </section>
				<section>
                    <script src="https://gist.github.com/sbuscher/b415862977359b4c7274ad00215c2558.js"></script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        ```
                        import arcpy

                        arcpy.AddMessage("yo!")
                        print("hey")
                        ```
                    </script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        ```
                        # ----------------------------------------------------------------------------------------------------
                        #  Python / Skype4Py example that prints out chat messages
                        #
                        #  Tested with  Skype4Py version 0.9.28.5 and Skype verson 3.8.0.96

                        import sys
                        import os
                        import time
                        import Skype4Py
                        import random
                        def ndsSay(ndsWords):
                            ndsIn = str(ndsWords)
                                zcmd='espeak "'+ndsTalk+'"'
                                    print zcmd
                                        f=os.popen(zcmd)
                                            f.close()
                                                ndsWords=""
                                                    ndsTalk=""
                                                        zcmd=''
                                                            ndsMonkey=''
                                                                    
                                                                    # ----------------------------------------------------------------------------------------------------
                                                                    # Fired on attachment status change. Here used to re-attach this script to Skype in case attachment is lost. Just in
                                                                    #case.
                                                                    def OnAttach(status):
                                                                        print 'API attachment status: ' + skype.Convert.AttachmentStatusToText(status)
                                                                            if status == Skype4Py.apiAttachAvailable:
                                                                                    skype.Attach()

                                                                                        if status == Skype4Py.apiAttachSuccess:
                                                                                               print('***************************************')


                                                                                               # ----------------------------------------------------------------------------------------------------
                                                                                               # Fired on chat message status change. 
                                                                                               # Statuses can be: 'UNKNOWN' 'SENDING' 'SENT' 'RECEIVED' 'READ'        

                                                                                               def OnMessageStatus(Message, Status):
                                                                                                   if Status == 'RECEIVED':
                                                                                                           print(Message.FromDisplayName + ': ' + Message.Body)
                                                                                                                   ndsSay(Message.FromDisplayName)
                                                                                                                           ndsSay(Message.Body)

                                                                                                                               if Status == 'READ':
                                                                                                                                       ndsMonkey = "todo"
                                                                                                                                               print(Message.FromDisplayName + ': ' + Message.Body)
                                                                                                                                                       ndsSay(Message.FromDisplayName)
                                                                                                                                                               ndsSay(Message.Body)

                                                                                                                                                                   if Status == 'SENT':
                                                                                                                                                                           print('Myself ' + Message.Body)


                                                                                                                                                                           # ----------------------------------------------------------------------------------------------------
                                                                                                                                                                           # Creating instance of Skype object, assigning handler functions and attaching to Skype.
                                                                                                                                                                           skype = Skype4Py.Skype()
                                                                                                                                                                           skype.OnAttachmentStatus = OnAttach
                                                                                                                                                                           skype.OnMessageStatus = OnMessageStatus

                                                                                                                                                                           print('***************************************')
                                                                                                                                                                           print 'Connecting to Skype..'
                                                                                                                                                                           skype.Attach()

                                                                                                                                                                           # ----------------------------------------------------------------------------------------------------
                                                                                                                                                                           # Looping until user types 'exit'
                                                                                                                                                                           Cmd = ''
                                                                                                                                                                           while not Cmd == 'exit':
                                                                                                                                                                               Cmd = raw_input('')
                        ```
                        <!-- .element: class="stretch" -->
                    </script>
                </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
